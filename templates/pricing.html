<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=yes">
    <title>–¢–∞—Ä–∏—Ñ—ã - SaaSPro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { background: #f8fafc; font-family: 'Inter', sans-serif; }
        .pricing-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 60px 0 80px; }
        .pricing-card { background: white; border-radius: 24px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.05); transition: all 0.3s; height: 100%; }
        .pricing-card:hover { transform: translateY(-10px); box-shadow: 0 20px 60px rgba(102,126,234,0.1); }
        .pricing-card.popular { border: 2px solid #667eea; position: relative; }
        .popular-badge { position: absolute; top: -12px; left: 20px; background: #667eea; color: white; padding: 6px 20px; border-radius: 50px; font-size: 0.8rem; font-weight: 600; }
        .price { font-size: 2.5rem; font-weight: 700; color: #2d3748; }
        .currency { font-size: 1rem; color: #a0aec0; }
        .period { font-size: 0.9rem; color: #718096; }
        .feature-list { list-style: none; padding: 0; margin-top: 20px; }
        .feature-list li { padding: 8px 0; border-bottom: 1px solid #e2e8f0; }
        .feature-list li:last-child { border-bottom: none; }
        .btn-subscribe { background: #667eea; color: white; border-radius: 50px; padding: 12px 30px; border: none; width: 100%; font-weight: 600; margin-top: 20px; }
        .btn-subscribe:hover { background: #5a67d8; }
        @media (max-width: 768px) { .pricing-header { padding: 40px 0 60px; } .pricing-card { margin-bottom: 20px; } }
    </style>
</head>
<body>
    <div class="pricing-header">
        <div class="container">
            <h1 class="display-4 fw-bold text-center">–¢–∞—Ä–∏—Ñ—ã –¥–ª—è –ª—é–±–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞</h1>
            <p class="lead text-center opacity-75">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–ª–∞–Ω –∏ –Ω–∞—á–Ω–∏—Ç–µ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å</p>
        </div>
    </div>

    <div class="container" style="margin-top: -40px;">
        {{ if .Plans }}
        <div class="row g-4">
            {{ range .Plans }}
            <div class="col-lg-3 col-md-6">
                <div class="pricing-card {{ if eq .Code "pro" }}popular{{ end }}">
                    {{ if eq .Code "pro" }}<span class="popular-badge">üî• –°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π</span>{{ end }}
                    <h3 class="fw-bold">{{ .Name }}</h3>
                    <p class="text-muted small">{{ .Description }}</p>
                    <div class="price mt-3">
                        {{ .PriceMonthly }} <span class="currency">{{ .Currency }}</span>
                        <span class="period">/–º–µ—Å</span>
                    </div>
                    <div class="small text-muted mb-3">
                        –∏–ª–∏ {{ .PriceYearly }} {{ .Currency }}/–≥–æ–¥ (—Å–∫–∏–¥–∫–∞ 17%)
                    </div>
                    <ul class="feature-list">
                        {{ $features := .Features | jsonParse }}
                        {{ range $features }}
                        <li><i class="fas fa-check text-success me-2"></i>{{ . }}</li>
                        {{ else }}
                        <li><i class="fas fa-check text-success me-2"></i>–ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</li>
                        {{ end }}
                        <li><i class="fas fa-users me-2"></i>–î–æ {{ .MaxUsers }} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</li>
                    </ul>
                    <button class="btn-subscribe" onclick="subscribe({{ .ID }})">
                        –í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ
                    </button>
                </div>
            </div>
            {{ end }}
        </div>
        {{ else }}
        <div class="text-center py-5">
            <div class="alert alert-info">
                <h4 class="alert-heading">–¢–∞—Ä–∏—Ñ—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</h4>
                <p class="mb-0">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.</p>
            </div>
        </div>
        {{ end }}
    </div>

    <div class="container mt-5 text-center">
        <p class="text-muted">–í—Å–µ —Ü–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Å –ù–î–°. –í–æ–∑–º–æ–∂–Ω–∞ –ø–æ–º–µ—Å—è—á–Ω–∞—è –∏ –≥–æ–¥–æ–≤–∞—è –æ–ø–ª–∞—Ç–∞.</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function subscribe(planId) {
            const period = confirm('–û–ø–ª–∞—Ç–∏—Ç—å –µ–∂–µ–º–µ—Å—è—á–Ω–æ? (OK - –º–µ—Å—è—Ü, –û—Ç–º–µ–Ω–∞ - –≥–æ–¥)') ? 1 : 12;
            fetch('/api/subscriptions', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ plan_id: planId, period_month: period })
            })
            .then(res => res.json())
            .then(data => {
                if (data.subscription) {
                    alert('–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞!');
                    window.location.href = '/my-subscriptions';
                } else {
                    alert('–û—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'));
                }
            })
            .catch(err => alert('–°–µ—Ç–µ–≤–∞—è –æ—à–∏–±–∫–∞'));
        }
    </script>
</body>
</html>
